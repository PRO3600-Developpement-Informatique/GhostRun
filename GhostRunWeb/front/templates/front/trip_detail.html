{% extends "base.html" %}
{% load static %}

{% block title %}
    GhostRun â€” L'application qui compare vos trajets
{% endblock %}

{% block head %}
    <script async
            defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAm-DOjQvHA_M9ew3amcMum6OoICE8TL9w"
            type="text/javascript"></script>
    <script async
            defer
            src="{% static "loadgpx.js" %}"
            type="text/javascript"></script>
{% endblock %}

{% block content %}
    <h2>{{ trip.name }}</h2>

    <div id="map"
         style="height: 75vh"></div>
    <script>
        function loadGPXFileIntoGoogleMap(map, filename) {
            $.ajax({
                url: filename,
                dataType: "xml",
                success: function (data) {
                    var parser = new GPXParser(data, map);
                    parser.setTrackColour("#00ccff");     // Set the track line colour
                    parser.setTrackWidth(3);          // Set the track line width
                    parser.setMinTrackPointDelta(0.001);      // Set the minimum distance between track points
                    parser.centerAndZoom(data);
                    parser.addTrackpointsToMap();         // Add the trackpoints
                    parser.addRoutepointsToMap();         // Add the routepoints
                    parser.addWaypointsToMap();           // Add the waypoints
                }
            });
        }

        $(document).ready(function () {
            var mapOptions = {
                zoom: 8,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            var map = new google.maps.Map(document.getElementById("map"),
                mapOptions);
            loadGPXFileIntoGoogleMap(map, "{% url "trip-gpx" pk=trip.id %}");
        });

    </script>


{% endblock %}